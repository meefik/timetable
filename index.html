<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Schedule / </title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
    <script type="text/javascript" src="/static/js/script.js"></script>
    <script type="text/javascript" src="/static/js/date.js"></script>
    <script type="text/javascript" src="/static/js/jquery.ui.datepicker-ru.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="http://underscorejs.org/underscore-min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <meta charset="utf-8">
</head>
<body>
<div class="row">
    <div class="col-md-12">
        <script>
    document.cdata = [
{
    "ID" : "x0002.01",
    "Name" : "Создание веб-интерфейсов с помощью HTML и CSS",
    "ShortName" : "Першин 1",
    "EnrollmentStart" : "01.09.2014",//Понедельники
    "CourseStart" : "22.09.2014",//Понедельники
    "Weeks" : 8
},
{
    "ID" : "x0003.01",
    "Name" : "Линейные электрические цепи",
    "ShortName" : "Усольцев 1",
    "EnrollmentStart" : "01.09.2014",//Понедельники
    "CourseStart" : "22.09.2014",//Понедельники
    "Weeks" : 10
},
 {
     "ID" : "x0005.01",
     "Name" : "RoboEd – Практическая робототехника",
     "ShortName" : "Капитонов",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "22.09.2014",//Понедельники
     "Weeks" : 8,
     "Checkings" : ["Съемка", "Загрузка"],
     "TestCheck" : [{"Съемка" : true}, {"Загрузка" : false}]
 },
 {
     "ID" : "x0008.00",
     "Name" : "Введение в технологии веб-программирования (Javascript)",
     "ShortName" : "Javascript",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "29.09.2014",//Понедельники
     "Weeks" : 6
 },
 {
     "ID" : "x0007.00",
     "Name" : "RoboEd – Основы робототехники",
     "ShortName" : "Капитонов 2",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "13.10.2014",//Понедельники
     "Weeks" : 11
 },
 {
     "ID" : "x0009.00",
     "Name" : "Введение в технологии веб-программирования (PHP)",
     "ShortName" : "PHP",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "13.10.2014",//Понедельники
     "Weeks" : 8
 },
 {
     "ID" : "x0001.02",
     "Name" : "Теория графов",
     "ShortName" : "Лисицына",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "03.11.2014",//Понедельники
     "Weeks" : 8
 },
 {
     "ID" : "x0004.01",
     "Name" : "Создание продвинутых веб-интерфейсов с помощью HTML5 и CSS3",
     "ShortName" : "Першин 2",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "03.11.2014",//Понедельники
     "Weeks" : 10
 },
 {
     "ID" : "x0006.00",
     "Name" : "Основы электромеханических систем",
     "ShortName" : "Субботин",
     "EnrollmentStart" : "01.09.2014",//Понедельники
     "CourseStart" : "17.11.2014",//Понедельники
     "Weeks" : 9
 },
{
    "ID" : "x0005.02",
    "Name" : "RoboEd – Практическая робототехника",
    "ShortName" : "Капитонов",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "12.01.2015",//Понедельники
    "Weeks" : 8,
    "Checkings" : ["Съемка", "Загрузка"],
    "TestCheck" : [{"Съемка" : true}, {"Загрузка" : false}]
},
{
    "ID" : "x0007.01",
    "Name" : "RoboEd – Основы робототехники",
    "ShortName" : "Капитонов 2",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "12.01.2015",//Понедельники
    "Weeks" : 11
},
{
    "ID" : "x0008.01",
    "Name" : "Введение в технологии веб-программирования (Javascript)",
    "ShortName" : "Javascript",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "12.01.2015",//Понедельники
    "Weeks" : 6
},
{
    "ID" : "x0009.01",
    "Name" : "Введение в технологии веб-программирования (PHP)",
    "ShortName" : "PHP",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "12.01.2015",//Понедельники
    "Weeks" : 8
},
{
    "ID" : "x0002.02",
    "Name" : "Создание веб-интерфейсов с помощью HTML и CSS",
    "ShortName" : "Першин 1",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "23.02.2015",//Понедельники
    "Weeks" : 8
},
{
    "ID" : "x0003.02",
    "Name" : "Линейные электрические цепи",
    "ShortName" : "Усольцев 1",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "09.03.2015",//Понедельники
    "Weeks" : 10
},
{
    "ID" : "x0001.03",
    "Name" : "Теория графов",
    "ShortName" : "Лисицына",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "23.03.2015",//Понедельники
    "Weeks" : 8
},
{
    "ID" : "x0006.01",
    "Name" : "Основы электромеханических систем",
    "ShortName" : "Субботин",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "06.04.2015",//Понедельники
    "Weeks" : 9
},
{
    "ID" : "x0010.00",
    "Name" : "Введение в теорию механизмов и машин",
    "ShortName" : "Мехатроники",
    "EnrollmentStart" : "29.12.2014",//Понедельники
    "CourseStart" : "06.04.2015",//Понедельники
    "Weeks" : 10
},
{
    "ID" : "x0004.02",
    "Name" : "Создание продвинутых веб-интерфейсов с помощью HTML5 и CSS3",
    "ShortName" : "Першин 2",
    "EnrollmentStart" : "12.12.2014",//Понедельники
    "CourseStart" : "20.04.2015",//Понедельники
    "Weeks" : 10
}
];
	
	
	
    document.offline = true;    
    $(document).ready(function () {
        setDefaultDatas();
       
        $("#from").datepicker({
            "dateFormat" : "dd.mm.yy",
            "changeMonth": true,
            "changeYear": true
        });
        $("#to").datepicker({
            "dateFormat" : "dd.mm.yy",
            "changeMonth": true,
            "changeYear": true
        });

        _.templateSettings = {
            evaluate: /\{\{(.+?)\}\}/g,
            interpolate: /\{\{=(.+?)\}\}/g,
            escape: /\{\{-(.+?)\}\}/g
        };
    });


</script>

<form id="datesForm" class="form-inline">
    <div class="form-group">
        <label for="from">Начальная дата</label>
        <input onchange="processInputChange(this, 'from')" type="text" class="form-control" id="from" placeholder="1">
    </div>
    <div class="form-group">
        <label for="to">Конечная дата</label>
        <input onchange="processInputChange(this, 'to')" type="text" class="form-control" id="to" placeholder="1">
    </div>
    <button onclick="show(); return false;" class="btn btn-default">Показать</button>
</form>

<br/>

<div id="data">

</div>

<div class="modal" id="modal-window">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="hideModal()"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="modal-title"></h4>
            </div>
            <div class="modal-body" id="modal-body">
                <div id="modal-body-body">

                </div>
                <div id="modal-history">

                </div>
                <div id="modal-body-head">

                </div>
            </div>
            <div class="modal-footer">

            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
        <script type="text/template" id="table-main">
            <table class="table table-condensed table-bordered" id="courses-table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Название</th>
                    {{ _.each(headers, function(oneDate) { }}
                    <th class="header-week {{ if (oneDate.current){ }} current {{ } }}"
                        title="{{=oneDate.year}} {{ if (oneDate.current){ }} , текущая неделя {{ } }}">{{=oneDate.date}}
                    </th>
                    {{ }); }}
                </tr>
                </thead>
                <tbody>
                {{ _.each(courses, function(course) { }}
                <tr>
                    <td class="header-id"><span>{{=course.ID}}</span></td>
                    <td class="header-name" title="{{=course.Name}}"><span>{{=course.ShortName}}</span>{{if (!document.offline){ }}<span
                            class="glyphicon week-button {{if (course.State){ }} glyphicon-ok-circle {{ } else { }} glyphicon-warning-sign week-warning {{ } }}"
                          onclick="showModalCourse('{{=course.ID}}')"
                            title="{{if (!course.State){ }} Не выполнены условия {{ } }}"></span>{{ } }}</td>
                    {{ _.each(course.Weeks, function(week){ }}
                    <td {{if (week.current){ }} class="current" {{ } }}>
                        {{ if (week.enrollment) { }}
                        <div class="element enrollment" title="Регистрация"><span class='glyphicon glyphicon-plus'></span></div>
                        {{ } }}

                        {{ if (week.weekNumber) { }}
                        <div class="element week" title="Неделя {{=week.weekNumber}}">{{=week.weekNumber}}</div>
                        {{ } }}

                        {{ if (week.prolongation) { }}
                        <div class="element prolongation" title="Продление"><span class='glyphicon glyphicon-repeat'></span></div>
                        {{ } }}

                        {{ if (week.open) { }}
                        <div class="element open" title="Открытие в воскресенье"><span class='glyphicon glyphicon-folder-open'></span></div>
                        {{ } }}

                        {{ if (week.certificate) { }}
                        <div class="element certificate" title="Выдача сертификатов"><span class='glyphicon glyphicon-file'></span></div>
                        {{ } }}
                    </td>
                    {{ }); }}
                </tr>
                {{ }); }}
                </tbody>
            </table>
        </script>

        <script type="text/template" id="checkitem-main">
            <input type="hidden" id="currentCourse" value="{{= courseId}}">
            <table class="table">
                <thead>
                <tr>
                    <th>&nbsp;</th>
                    <th>Параметр</th>
                    <th>Состояние</th>
                    <th>&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                {{ _.each(checkitems, function(item) { }}
                <tr>
                    <td>
                        <button class="btn btn-default btn-xs" onclick="showCheckItemHistory(this, {{= item.ID}})"><span
                                title="История изменений" class="glyphicon glyphicon-comment"></span></button>
                    </td>
                    <td>{{= item.Name}}</td>
                    <td><input type="checkbox" onchange="processCheckitemChange(this, {{= item.ID}})"
                        {{ if (item.CurrentState ){ }} checked="checked" {{ } }}
                        >
                    </td>
                    <td>
                        <button class="btn btn-default btn-xs" onclick="processCheckitemDuplicate({{= item.ID}})"
                                title="Продублировать текущее состояние для добавления комментария"><span
                                class="glyphicon glyphicon-repeat"></span></button>
                    </td>
                </tr>
                {{ }); }}
                </tbody>
            </table>
        </script>

        <script type="text/template" id="checkitem-history-table">
            <input type="hidden" id="currentCheckItem" value="{{= checkItemId}}">
            <table id='history' class='table' style=''>
                <thead>
                <tr style='display: block'>
                    <th>Состояние</th>
                    <th>Пользователь</th>
                    <th>Дата</th>
                    <th>Комментарий</th>
                    <th>&nbsp;</th>
                </tr>
                </thead>
                <tbody id='tb-history'>

                {{ _.each(checkitemHistorys, function(item) { }}
                <tr>
                    <td><input type="checkbox" disabled="disabled" {{ if (item.State){ }} checked="checked" {{ } }}">
                    </td>
                    <td>{{= item.User.Name}}</td>
                    <td>{{= item.Date}}</td>
                    <td>
                        <span class="history-comment-txt">{{= item.Comment}}</span>
                        <span class="history-comment-edit">
                            <textarea>{{- item.Comment}}</textarea><br/>
                            <button onclick="saveHistoryComment(this, {{= item.ID}});"
                                    title="Сохранить комментарий"
                                    class="btn btn-default btn-xs"><span class="glyphicon glyphicon-ok"></span></button>
                        </span>
                    </td>
                    <td>
                        <button onclick="toggleHistoryComment(this)"
                                class="btn btn-default btn-xs"
                                title="Редактировать / Закрыть"><span class="glyphicon glyphicon-pencil"></span>
                        </button>
                    </td>
                </tr>
                {{ }); }}
                </tbody>
            </table>

        </script>

    </div>
</div>
</body>
</html>